<%= form_for(@event, :id =>"fuelux-wizard" ,:class =>"form-horizontal" , :url => path) do |f| %>
  <% if @event.errors.any? %>
  <% content_for :scripts do %>
    <script type="text/javascript">
      <% content_for :inner_scripts do %>
       <% @event.errors.full_messages.each do |message| %>
        $(document).ready(function () {
          $.bigBox({
            title: "<%= message %>",
            content: "",
            color: "#b94a48",
            iconSmall: "fa fa-times bounce animated",
            icon : "fa fa-exclamation fadeInLeft animated"
          });     
        });
       <% end %>
      <% end %>
    </script>
  <% end %>
  <% end %>


  <div class="widget-body fuelux">

            <div class="wizard">
              <ul class="steps">
                <li data-target="#step1" class="active">
                  <span class="badge badge-info">1</span>Step 1<span class="chevron"></span>
                </li>
                <li data-target="#step2">
                  <span class="badge">2</span>Step 2<span class="chevron"></span>
                </li>
                <li data-target="#step3">
                  <span class="badge">3</span>Step 3<span class="chevron"></span>
                </li>
                <li data-target="#step4">
                  <span class="badge">4</span>Step 4<span class="chevron"></span>
                </li>
                <li data-target="#step5">
                  <span class="badge">5</span>Step 5<span class="chevron"></span>
                </li>
              </ul>
              <div class="actions">
                <button type="button" class="btn btn-sm btn-primary btn-prev">
                  <i class="fa fa-arrow-left"></i>Prev
                </button>
                <button type="button" class="btn btn-sm btn-success btn-next" data-last="Finish">
                  Next
                <i class="fa fa-arrow-right"></i></button>
              </div>
            </div>
            <div class="step-content">
              <form class="form-horizontal" id="fuelux-wizard" method="post">

                <div class="step-pane active" id="step1">
                  <h3><strong>Step 1 </strong> - Basic Data</h3>

                  <!-- wizard form starts here -->
                  <fieldset>

                      <div class="row">
                        <div class="col-sm-12">
                          <div class="form-group">
                            <div class="input-group">
                              <span class="input-group-addon">Event Name</span>
                              <%= f.text_field :event_name, autofocus: true , :class => "form-control input-lg"%>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-sm-6">
                          <div class="form-group">
                            <div class="input-group">
                              <span class="input-group-addon">Department</span>
                              <%= f.text_field :department, autofocus: true , :class => "form-control input-lg"%>
                            </div>
                          </div>
                        </div>
                        <div class="col-sm-6">
                          <div class="form-group">
                            <div class="input-group">
                              <span class="input-group-addon">Point Value</span>
                               <%= f.text_field :point_val, autofocus: true , :class => "form-control input-lg"%>
                            </div>
                          </div>
                        </div>
                      </div>

                  </fieldset>

                </div>

                <div class="step-pane" id="step2">
                  <h3><strong>Step 2 </strong> - Description</h3>


                      <div class="row">
                        <div class="col-sm-12">
                          <%= tinymce %>
                          <%= f.text_area :description, autofocus: true, :class => "tinymce", :rows => 20 %>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-sm-12">
                          <%= f.label "Image:" ,:class => "col-md-3 control-label"%>
                          <%= f.file_field :image %>
                        </div>
                      </div>

                </div>

                <div class="step-pane" id="step3">
                    <h3><strong>Step 3 </strong> - Time & Place</h3>
                      <div class="row">
                        <div class="col-md-12">
                          <h2 class="row-seperator-header"><i class="fa fa-clock-o"></i> Time </h2>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-sm-12">
                          <div class="form-group">
                            <div class="input-group">
                              <span class="input-group-addon">Time</span>
                              <%= text_field_tag "time", "time", :id => "daterange", :class => "form-control input-lg", :size => "150" %>
                            </div>
                          </div>
                        </div>
                      </div>

                      <div class="row">
                        <div class="col-md-12">
                          <h2 class="row-seperator-header"><i class="fa fa-map-marker"></i> Location </h2>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-sm-6">
                          <div class="form-group">
                            <div class="input-group">
                              <span class="input-group-addon">Department</span>
                              <%= f.collection_select :location_id, Location.order(:building_name), :id, :building_name, include_blank: true , :value =>  "Blank" %>
                            </div>
                          </div>
                        </div>
                        <div class="col-sm-6">
                          <div class="form-group">
                            <div class="input-group">
                              <span class="input-group-addon">Rooms</span>
                               <%= f.grouped_collection_select(:room_numbers, Location.all, :rooms, :building_name, :id, :room_number, {:include_blank => false}, { :multiple => true })%>
                            </div>
                          </div>
                        </div>
                      </div>
                </div>

                <div class="step-pane" id="step4">
                  <h3><strong>Step 4 </strong> - Recurring Event</h3>
                      <div class="row">
                        <div class="col-sm-12">
                          <div class="form-group">
                            <div class="input-group">
                              <span class="input-group-addon">Reccuring Event</span>
                              <%= f.check_box :recurring_id , :class => "smart-control form-control"%>
                            </div>
                          </div>
                        </div>
                      </div>
       
                      <div class="row">
                        <div class="col-sm-12">
                          <div class="form-group">
                            <div class="input-group">
                              <span class="input-group-addon hidden" id="lblRecure">Excluding</span>
                              <%= text_field_tag "exclude", "", :class => "hidden form-control", placeholder: "March 21 2016, March 22 2016" %>
                            </div>
                          </div>
                        </div>
                      </div>

                      <div class="row">
                        <div class="col-sm-12">
                          <div class="form-group">
                            <div class="input-group">
                              <span class="input-group-addon hidden" id="lblEnd">Stop Date</span>
                              <%= text_field_tag "recudeEndDate", "", :placeholder => "March 21 2016", :class => "hidden form-control", :size => "150" %>
                            </div>
                          </div>
                        </div>
                      </div>

    
                      <div class="row">
                        <div class="col-sm-12">
                          <div class="form-group col-md-offset-5">
                            <%= hidden_field_tag :created_by, :value => @event.created_by %>
                            <%= hidden_field_tag :updated_by, :value => current_user.id %>
                            <%= f.submit "Save" , :id => "submitForm", :class => "hidden col-md-2 btn btn-primary btn-lg"%>
                          </div>
                        </div>
                      </div>
                </div>

                <div class="step-pane" id="step5">
                  <h3><strong>Step 5 </strong> - Finished!</h3>
                  <br>
                  <br>
                  <h1 class="text-center text-success"><i class="fa fa-check"></i> Congratulations!
                  <br>
                  <small>Click finish to end wizard</small></h1>
                  <br>
                  <br>
                  <br>
                  <br>
                </div>

              </form>
            </div>

          </div>

<% end %>

<style>
#event_room_numbers{
  height:200px;
  width:100px;
}
.smart-style-5 .bootstrapWizard li .title{
  color:white;
}
</style>
<% content_for :scripts do %>
<script type="text/javascript">
  <% content_for :inner_scripts do %>

var value = "";
var dates = "";
  $(document).ready(function () {
  pageSetUp();    

        var wizard = $('.wizard').wizard();

        wizard.on('finished', function (e, data) {
          $("#submitForm").click();
          /*$.smallBox({
            title: "Congratulations! Your form was submitted",
            content: "<i class='fa fa-clock-o'></i> <i>1 seconds ago...</i>",
            color: "#5F895F",
            iconSmall: "fa fa-check bounce animated",
            timeout: 4000
          });*/
          
        });

    
    })






$('#event_recurring_id').click(function () {
            if(document.getElementById('event_recurring_id').checked)
            {
              $('#exclude').removeClass("hidden");
              $("#lblRecure").removeClass("hidden");
              $("#lblEnd").removeClass("hidden");
            
              $("#recudeEndDate").removeClass("hidden");
              
              $('#exclude').val(value);
               $('#recudeEndDate').val(dates);
            }
            else
            {
              $('#exclude').addClass("hidden");
              $("#lblRecure").addClass("hidden");
              $("#recudeEndDate").addClass("hidden");
              $("#lblEnd").addClass("hidden");

              dates = $('#recudeEndDate').val();
              $('#recudeEndDate').val("");

              value = $('#exclude').val();
              $('#exclude').val("");
            }
        });
        

<% if page_type == "Edit" %>
<% array = (@event.room_numbers.join(',')) %>
$('#event_room_numbers').parent().show();
var data= "<%= array %>";
var dataarray=data.split(",");
$("#event_location_id").val("<%= @event.location_id %>");
$("#event_location_id").trigger("change");
$("#event_room_numbers").val(dataarray);
<% end %>

$('#event_room_numbers').addClass("form-control input-lg");
$('#event_location_id').addClass("form-control input-lg");
$('#daterange').daterangepicker({
  <% if page_type == "Edit" %>
    "startDate": "<%= @event.day_time.to_s(:datepicker)%>",
    "endDate": "<%= @event.end_time.to_s(:datepicker)%>",
    <% end %>
    "drops": "down",
    "applyClass": "btn  btn-primary",
    "showDropdowns": true,
    "timePicker": true,
    "timePickerIncrement": 30,
    "locale": {
      "format": 'MM/DD/YYYY h:mm A'
        },
    "autoApply": true,
});


  $(function () {
  $('[data-toggle="popover"]').popover()
})

  $("#new_event").validate({
  rules : {
    "event[event_name]" : {
      required: true
    },
    "event[department]" : {
      required: true
    },
    "event[point_val]" : {
      required: true
    },
      "event[day_time]" : {
      required: true
    },
    "event[description]" : {
        required: true
    },
    "event[location_id]" : {
        required: true
    },
    "event[room_numbers][]" : {
      required: true
    }
  },
  showErrors: function(errorMap, errorList) {
    $.each(this.successList, function(index, value) {
      return $(value).popover("hide");
    });
    return $.each(errorList, function(index, value) {
      var _popover;
      _popover = $(value.element).popover({
        trigger: "manual",
        placement: "top",
        content: value.message,
        template: "<div class=\"popover\"><div class=\"arrow\"></div><div class=\"popover-inner\"><div class=\"popover-content\"><p></p></div></div></div>"
      });
      // Bootstrap 3.x :      
      _popover.data("bs.popover").options.content = value.message;
      return $(value.element).popover("show");
    });
  }
});
    



  <% end %>
  <%= content_for :inner_scripts %>
</script>
<% end %>









